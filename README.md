# PRM_4_113603

Below is an illustration of the MLOps workflow in terms of the Generate+ETL (GETL) framework used in **Phys. Rev. Materials 4, 113603** (DOI: https://doi.org/10.1103/PhysRevMaterials.4.113603; or the [preprint](https://www.researchgate.net/publication/345634787_Chemical_bonding_in_metallic_glasses_from_machine_learning_and_crystal_orbital_Hamilton_population)):

![MLOPs workflow used in PRM_4_113603](img/PRM_4_113603_MLOps.drawio.png)

üß† **IMPORTANT**: Note that the proposed approach organically matches a **human-in-the-loop active learning process embedded within a physics-informed MLOps pipeline**. Data acquisition based on model performance was done by mixing **exploit** (**data augmentation**) and **explore** (restarting the **Pre-Deployment** pipeline and looking for new Classical Molecular Dynamics samples or new Nominal Compositions).

‚ö†Ô∏è **NOTE:** The results were not obtained following industry MLOps practices, since I was working solo and under constrained local computing conditions. Although I had access to the [SDumont supercomputer](https://sdumont.lncc.br) (HPC), the service was not cloud-native. This meant there was no possibility of using modern workflows such as REST API calls to submit jobs or retrieve results. Consequently, there was no support for automation practices like CI/CD, workflow orchestration, or programmatic job management. All processes for data generation, model training/monitoring, and deployment were manual.

‚ö†Ô∏è **NOTE:** Check ongoing work for MLOps modernization of the Generate+ETL (GETL) framework above at:

- https://github.com/aryrfjr/PRM_4_113603_MLOps-P1.
- https://github.com/aryrfjr/PRM_4_113603_MLOps-P3.

üìù **NOTE:** Regarding code quality and best practices, I started a refactoring work once and extracted some features into a separate and reusable library named üì¶ [theo4m](https://github.com/aryrfjr/theo4m), which is used in the Python scripts in the folder üóÇÔ∏è [**scripts**](https://github.com/aryrfjr/PRM_4_113603/tree/main/scripts).

## üß™ 1. Problem Definition & Domain Context

- **Goal**: Predict chemical **bond strengths** (-ICOHP values) in metallic glasses at density functional theory (DFT)-level accuracy.

  - üìù **NOTE**: Within the context of Computational Chemistry, the "integrated COHP (the -ICOHP value) hints towards the **bond strength**"; COHP stands for ([Crystal Orbital Hamilton Populations](https://schmeling.ac.rwth-aachen.de/cohp/index.php?menuID=1)).

- **Challenge**: Direct DFT computation is computationally infeasible for large-scale (e.g. 10k-atom) systems, whose atomic level whole structure is more realistic.

## üß© 2. Data Generation & Labeling (DataOps phase)

- **Raw Data Sources**:

  - Classical Molecular Dynamics (CMD) simulations are used to to generate an ensemble of smaller systems (100-atom cells) whose atomic level local environments are representative of those found on large-scale systems.

  - Feasible first-principles electronic structure simulations based on DFT to compute -ICOHP values (**labels**) for the smaller systems.

- **Data Engineering**:

  - Convert atomic configurations (local environment around central atoms in terms of its neighbours; or simply **local atomic fingerprints**) to SOAP descriptors (**feature engineering**).
 
    - üìù **NOTE**: Within the context of Computational Chemistry/Materials Science, SOAP stands for ([Smooth Overlap of Atomic Positions](https://doi.org/10.1103/PhysRevB.87.184115)).

  - Database of interactions (DBIs) includes **bond distance**, **bond strengths**, and **local atomic fingerprints**.
  
- **Labeling Strategy**:

  - -ICOHP values calculated via DFT and COHP analysis are used as **supervised labels**.

## üõ†Ô∏è 3. Model Development (ModelOps phase)

- **Machine Learning (ML) Approach**: Gaussian Process Regression (GPR).

- **Feature Inputs**:

  - SOAP vectors for atoms in bonds (the SOAP descriptor itself is a feature vector; the ***dot product-based SOAP kernel*** measures similarity and can be used to derive a ***metric distance***).

  - Bond distances.

- **Custom Kernel Function**:

  - Designed to combine bond distance and SOAP similarity.

- **Output**: Predicted -ICOHP value (bond strength).

- **Evaluation**:

  - Root Mean Square Error (RMSE) on test data per **bond/interaction type**.
 
  - **Data augmentation** by applying geometric transformations (shear, tension, compression) to 100-atom cells generated by MD simulations to generate more structural diversity and improve ML generalization.

  - Satisfactory performance demonstrated with small training sets.

- üí° **NOTE**: Maybe a Generative AI (GenAI) based approach could be used to generate the initial ensembles of smaller systems (100-atom cells) or for **data augmentation**.

## üìå Directories in this Root Folder:

- üóÇÔ∏è [**scripts**](https://github.com/aryrfjr/PRM_4_113603/tree/main/scripts): this folder contains the essential Python and Bash scripts which make up the implemented MLOps workflow used in that work. The scripts were used at different stages of the research (tests, development, and application) and are operational at a high technical level manual execution of the Python/Shell-based GETL pipelines depicted in the diagram above.

- üóÇÔ∏è [**data_examples**](https://github.com/aryrfjr/PRM_4_113603/tree/main/data_examples): this folder contains samples of the data generated for the nominal compositions Zr‚ÇÑ‚ÇâCu‚ÇÑ‚ÇâAl‚ÇÇ (majority) and Zr‚ÇÑ‚ÇÖCu‚ÇÑ‚ÇÖAl‚ÇÅ‚ÇÄ.

- üóÇÔ∏è [**atomistic_models**](https://github.com/aryrfjr/PRM_4_113603/tree/main/atomistic_models): this folder contains simulation-specific model inputs used for the generation of **automated/reproducible synthetic training raw data** from atomistic simulations using LAMMPS (a CMD simulator) and Quantum ESPRESSO (a first-principles electronic structure code based on density functional theory, DFT). These models inputs are the EAM potentials and the pseudopotentials used in the simulations.

- üóÇÔ∏è [**img**](https://github.com/aryrfjr/PRM_4_113603/tree/main/img): this folder contains some figures used in the README files of this repository.

üìù **NOTE**: The immediate subfolders of **scripts** and **data_examples** correspond to each step/phase illustrated in the diagram above:

- **Generate** (**DataOps phase**).
  
- **ETL model** (**ModelOps phase**).
  
- **Train/Tune** (**observability** or **model evaluation** in the **ModelOps phase**).
  
- **ETL inference** (after **Deployment/Production**).

‚ö†Ô∏è **NOTE**: Under each one of the directories above, the original subfolder structure used to produce the results reported in **Phys. Rev. Materials 4, 113603** are replicated. The structure of the two root folders **ML** and **SS-ML** are the same as those used in the original Python/Shell-based GETL pipelines depicted in the diagram above.

## üì¶ Third-Party Software Used in Atomistic Simulations

### Simulation Software

- **LAMMPS**

  - **Purpose**: Classical Molecular Dynamics (CMD) simulations.
 
  - **Use Case**: Generate 100-atom and 10,000-atom amorphous metallic glass structures.
 
  - **License**: Open-source (GPL).
 
  - **Reference**: Plimpton, J. Comput. Phys. 117, 1 (1995).
 
- **Quantum ESPRESSO (QE)**

  - **Purpose**: Density Functional Theory (DFT) calculations.
 
  - **Use Case**: Compute electronic structures for 100-atom cells to obtain COHP values.
 
  - **License**: Open-source (GPL).
 
  - **Reference**: Giannozzi et al., J. Phys.: Cond. Matter 21, 395502 (2009).
 
- **LOBSTER**

  - **Purpose**: Projected Crystal Orbital Hamilton Population (pCOHP) analysis.
 
  - **Use Case**: Extract bond strength information (‚ÄìICOHP) from DFT wavefunctions (QE output).
 
  - **License**: Free for academic use.
 
  - **Reference**: Maintz et al., J. Comput. Chem. 37, 1030 (2016).
 
### Descriptor Calculation

- **QUIP / libAtoms**
 
  - **Purpose**: Calculation of Smooth Overlap of Atomic Positions (SOAP) descriptors.
 
  - **Use Case**: Featurize atomic local environments for machine learning input.
 
  - **License**: Open-source (academic license required for some parts).
 
  - **Reference**: Bart√≥k et al., Phys. Rev. B 87, 184115 (2013).
